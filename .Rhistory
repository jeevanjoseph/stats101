read.csv(file = "https://tasks.wgu.edu/042461d5-fb27-4b4f-82ce-7b699810a75a")
read.csv(file = "https://tasks.wgu.edu/042461d5-fb27-4b4f-82ce-7b699810a75a")
setwd("~/Documents/MSDA/C744")
read.csv(file = "WA_Fn-UseC_-Telco-Customer-Churn.csv")
data <- read.csv(file = "WA_Fn-UseC_-Telco-Customer-Churn.csv")
summary(data)
View(data)
plot(data$MonthlyCharges)
warnings()
plot(data$MonthlyCharges,data$Churn)
plot(data$tenure,data$MonthlyCharges)
View(data[PhoneService='Yes'])
View(data[,PhoneService='Yes'])
no_phone<-data[which(data$PhoneService='Yes')]
no_phone<-data[which(data$PhoneService='Yes'),]
no_phone<-data[which(data$PhoneService=='Yes'),]
View(no_phone)
no_phone<-data[which(data$PhoneService!='Yes'),]
View(no_phone)
summary(no_phone$Churn)
install.packages("vcd")
data[which(data$PhoneService!='Yes'),]
data[which(data$PhoneService!='Yes'),5]
data[which(data$PhoneService!='Yes'),1]
data[which(data$PhoneService!='Yes'),0]
data[which(data$PhoneService!='Yes'),2]
data[which(data$PhoneService!='Yes'),1-5]
data[which(data$PhoneService!='Yes'),2-5]
data[which(data$PhoneService!='Yes'),2:5]
data[which(data$PhoneService!='Yes'),c(2,6:15)]
data[which(data$PhoneService!='Yes'),c(2,6:15)]
install.packages("vcd")
library(vcd)
mosaic(data ~ gender+Churn)
mosaic(~ gender+Churn, data = data)
mosaic(~ gender+PaymentMethod+Churn, data = data)
mosaic(~ gender+PaymentMethod+Churn, data = data,shade=TRUE)
data.frame(data)
data
data <- read.csv(file = "WA_Fn-UseC_-Telco-Customer-Churn.csv",header = TRUE)
data
mosaic(~ gender+PaymentMethod+Churn, data = data,shade=TRUE)
mosaic(~ gender+PaymentMethod+Churn, data = data,shade=TRUE)
mosaic(frequency(Churn)~ gender+PaymentMethodJ+Churn, data = data,shade=TRUE)
mosaic(frequency(Churn)~ gender+PaymentMethod+Churn, data = data,shade=TRUE)
mosaic(frequency(data$Churn)~ gender+PaymentMethod+Churn, data = data,shade=TRUE)
mosaic(Churn~ gender+PaymentMethod+Churn, data = data,shade=TRUE)
mosaic(Churn~ gender+PaymentMethod, data = data,shade=TRUE)
mosaic(Churn~ gender+PaymentMethod, data = data,shade=TRUE, legend=FALSE)
mosaic(Churn~ gender+PaymentMethod, data = data,shade=TRUE, legend=TRUE)
mosaic(Freq~ gender, data = data,shade=TRUE, legend=TRUE)
mosaic(Churn, data = data,shade=TRUE, legend=TRUE)
mosaic(gender, data = data,shade=TRUE, legend=TRUE)
mosaic(data$gender, data = data,shade=TRUE, legend=TRUE)
mosaic(~gender, data = data,shade=TRUE, legend=TRUE)
mosaic(~Churn, data = data,shade=TRUE, legend=TRUE)
mosaic(~Churn, data = data,shade=TRUE, legend=TRUE)
mosaic(Churn~gender+SeniorCitizen, data = data,shade=TRUE, legend=TRUE)
mosaic(~gender+SeniorCitizen, data = data,shade=TRUE, legend=TRUE)
mosaic(~gender+PaymentMethod, data = data,shade=TRUE, legend=TRUE)
mosaic(~gender+PaymentMethod+Churn, data = data,shade=TRUE, legend=TRUE)
mosaic(~gender+PaymentMethod+Churn, data = data,shade=TRUE)
library(corrplot)
install.packages("corrplot")
library(corrplot)
corrplot(data,method="ellipse")
data<- read.csv(file="WA_Fn-UseC_-Telco-Customer-Churn.csv")
mosaicplot(Churn~Contract,data=data)
data<- read.csv(file="WA_Fn-UseC_-Telco-Customer-Churn.csv")
mosaicplot(Churn~Contract,data=data)
mosaicplot(Churn~Contract+gender,data=data)
data<- read.csv(file="WA_Fn-UseC_-Telco-Customer-Churn.csv")
mosaicplot(Churn~Contract,data=data)
mosaicplot(Churn~Contract+gender,data=data)
data<- read.csv(file="WA_Fn-UseC_-Telco-Customer-Churn.csv")
mosaicplot(Churn~Contract,data=data)
device.off()
graphics.off()
mosaicplot(Churn~Contract+gender,data=data)
par()
warnings()
graphics.off()
mosaicplot(Churn~Contract,data=data)
warnings()
mosaicplot(Churn~Contract,data=data)
warnings()
mosaicplot(Churn~Contract,data=data)
warnings()
warnings()
mosaicplot(Churn~Contract,data=data)
graphics.off()
mosaicplot(Churn~Contract,data=data)
data<- read.csv(file="WA_Fn-UseC_-Telco-Customer-Churn.csv")
par(font.axis = 2)
par(font.lab = 2)
mosaicplot(Churn~Contract,data=data)
device.off()
graphics.off()
mosaicplot(Churn~Contract+gender,data=data)mosaicplot(Churn~Contract+SeniorCitizen,data=data)
mosaicplot(Churn~Contract+PhoneService,data=data)
data<- read.csv(file="WA_Fn-UseC_-Telco-Customer-Churn.csv")
par(font.axis = 3)
par(font.lab = 3)
mosaicplot(Churn~Contract,data=data)
plot(cars)
data<- read.csv(file="WA_Fn-UseC_-Telco-Customer-Churn.csv")
par(font.axis = 3)
par(font.lab = 3)
mosaicplot(Churn~Contract,data=data)
warnings()
data<- read.csv(file="WA_Fn-UseC_-Telco-Customer-Churn.csv")
par(font.axis = 3)
par(font.lab = 3)
par(font.default =3)
par()
par(font.main = 3)
par(font.default =3)
mosaicplot(Churn~Contract,data=data)
device.off()
graphics.off()
mosaicplot(Churn~Contract+gender,data=data)mosaicplot(Churn~Contract+SeniorCitizen,data=data)
mosaicplot(Churn~Contract+PhoneService,data=data)
data<- read.csv(file="WA_Fn-UseC_-Telco-Customer-Churn.csv")
par(font.axis = 3)
par(font.main = 3)
par(font.sub =3)
par(font.lab = 3)
mosaicplot(Churn~Contract,data=data)
device.off()
graphics.off()
mosaicplot(Churn~Contract+gender,data=data)mosaicplot(Churn~Contract+SeniorCitizen,data=data)
mosaicplot(Churn~Contract+PhoneService,data=data)
warnings()
data<- read.csv(file="WA_Fn-UseC_-Telco-Customer-Churn.csv")
par(font.axis = 5)
par(font.main = 5)
par(font.sub =5)
par(font.lab =5)
mosaicplot(Churn~Contract,data=data)
data<- read.csv(file="WA_Fn-UseC_-Telco-Customer-Churn.csv")
par(font.axis = 1)
par(font.main = 2)
par(font.sub =3)
par(font.lab =4)
mosaicplot(Churn~Contract,data=data)
par(font.main = 2)
par(font.sub =3)
par(font.lab =7)
mosaicplot(Churn~Contract,data=data)
device.off()
graphics.off()
mosaicplot(Churn~Contract+gender,data=data)mosaicplot(Churn~Contract+SeniorCitizen,data=data)
mosaicplot(Churn~Contract+PhoneService,data=data)
mosaicplot(Churn~Contract+MultipleLines,data=data)
mosaicplot(Churn~Contract,data=data)
mosaicplot(Churn~Contract+gender,data=data)
mosaicplot(Churn~Contract+SeniorCitizen,data=data)
mosaicplot(Churn~Contract+PhoneService,data=data)
mosaicplot(Churn~Contract+MultipleLines,data=data)
mosaicplot(Churn~Contract+PaperlessBilling,data=data)
mosaicplot(Churn~Contract+PaperlessBilling+PaymentMethod,data=data)
mosaicplot(Churn~Contract+PaymentMethod,data=data)
mosaicplot(Churn~gender+PaymentMethod,data=data)
mosaicplot(Churn~Dependents+PaymentMethod,data=data)
mosaicplot(Churn~Partner+Dependents+PaymentMethod,data=data)
mosaicplot(Churn~Dependents+PaymentMethod,data=data)
data$tenure_d <- cut(data$tenure,seq(0,120,6))
mosaicplot(Churn~Contract+PaymentMethod+tenure_d,data=data)
data$tenure_d <- cut(data$tenure,seq(0,120,24))
mosaicplot(Churn~Contract+PaymentMethod+tenure_d,data=data)
data$tenure_d <- cut(data$tenure,seq(0,90,24))
mosaicplot(Churn~Contract+PaymentMethod+tenure_d,data=data)
data$tenure_d <- cut(data$tenure,c(0,6,12,18,24,30,36,42,48,54,60,72,84,96,200))
mosaicplot(Churn~Contract+PaymentMethod+tenure_d,data=data)
data$tenure_d <- cut(data$tenure,c(0,6,12,24,36,48,60,84,200))
library(rpart)
fit <- rpart(Churn~Contract+PaymentMethod+tenure_d, method = 'class', data = data)
printcp(fit)
plotcp(fit)
fit <- rpart(Churn~tenure_d+Contract+PaymentMethod, method = 'class', data = data)
plotcp(fit)
View(data)
fit <- rpart(Churn~tenure_d+Contract+PaymentMethod+gender, method = 'class', data = data)
plotcp(fit)
printcp(fit)
fit <- rpart(Churn~tenure_d+Contract+PaymentMethod+gender+Phoneservice, method = 'class', data = data)
fit <- rpart(Churn~tenure_d+Contract+PaymentMethod+gender+PhoneService, method = 'class', data = data)
printcp(fit)
data[,"PhoneService"=="Yes"]
data[,PhoneService=="Yes"]
data[,data$PhoneService=="Yes"]
data[data$PhoneService=="Yes",]
data[data$PhoneService=="No",]
count(data[data$PhoneService=="No",])
rcount
nrow(data[data$PhoneService=="No",])
nrow(data[data$PhoneService=="No" && data$Churn=="Yes"])
nrow(data[data$PhoneService=="No" && data$Churn=="Yes",])
phone_data<-data[data$PhoneService=='Yes',]
nrow(phone_data)
View(phone_data)
X<-as.matrix(phone_data)
X<-as.matrix(phone_data,select=c(gender,SeniorCitizen,Partner,Dependents,tenure_d,PhoneService,MultipleLines,InternetService,OnlineSecurity,OnlineBackup,DeviceProtection,TechSupport)
)
X<-as.matrix(phone_data,select=c(gender,SeniorCitizen,Partner,Dependents,tenure_d,PhoneService,MultipleLines,InternetService,OnlineSecurity,OnlineBackup,DeviceProtection,TechSupport,StreamingTV,StreamingMovies,Contract,PaperlessBilling,PaymentMethod,MonthlyCharges,TotalCharges))
Y<-as.matrix(phone_data,select=c(Churn))
Y<-as.matrix(subset(phone_data,select=c(Churn)))
X<-as.matrix(subset(phone_data,select=c(gender,SeniorCitizen,Partner,Dependents,tenure_d,PhoneService,MultipleLines,InternetService,OnlineSecurity,OnlineBackup,DeviceProtection,TechSupport,StreamingTV,StreamingMovies,Contract,PaperlessBilling,PaymentMethod,MonthlyCharges,TotalCharges)))
churn_pca <- prcomp(X,scale = TRUE)
summary(TotalCharges)
summary(phone_data$MonthlyCharges)
phone_data$MonthlyCharges_q <- cut(phone_data$MonthlyCharges,c(0,45,75,92,120))
mosaicplot(Churn~Contract+PaymentMethod+tenure_d+MonthlyCharges_q,data=phone_data)
summary(phone_data$tenure)
data$tenure_d <- cut(data$tenure,c(0,9,29,56,72))
mosaicplot(Churn~Contract+PaymentMethod+tenure_d+MonthlyCharges_q,data=phone_data)
mosaicplot(Churn~Contract+PaymentMethod+tenure_d+MonthlyCharges_q,data=phone_data)
phone_data$tenure_d <- cut(phone_data$tenure,c(0,9,29,56,72))
mosaicplot(Churn~Contract+PaymentMethod+tenure_d+MonthlyCharges_q,data=phone_data)
mosaicplot(Churn~Contract+tenure_d+MonthlyCharges_q,data=phone_data)
summary(phone_data$TotalCharges)
phone_data$TotalCharges_q <- cut(phone_data$TotalCharges,c(0,415,1422,4026,8685))
mosaicplot(Churn~Contract+tenure_d+TotalCharges_q,data=phone_data)
mosaicplot(Churn~Contract+tenure_d+TotalCharges_q,data=phone_data)
data<- read.csv(file="WA_Fn-UseC_-Telco-Customer-Churn.csv")
mosaicplot(Churn~Contract,data=data)
mosaicplot(Churn~Contract+gender,data=data)
mosaicplot(Churn~Contract+SeniorCitizen,data=data)
mosaicplot(Churn~Contract+PhoneService,data=data)
mosaicplot(Churn~Contract+MultipleLines,data=data)
mosaicplot(Churn~Contract+PaperlessBilling,data=data)
mosaicplot(Churn~Contract+PaperlessBilling+PaymentMethod,data=data)
mosaicplot(Churn~Contract+PaymentMethod,data=data)
mosaicplot(Churn~gender+PaymentMethod,data=data)
mosaicplot(Churn~Dependents+PaymentMethod,data=data)
mosaicplot(Churn~Partner+Dependents+PaymentMethod,data=data)
mosaicplot(Churn~Dependents+PaymentMethod,data=data)
data$tenure_d <- cut(data$tenure,seq(0,120,6))
mosaicplot(Churn~Contract+PaymentMethod+tenure_d,data=data)
data$tenure_d <- cut(data$tenure,seq(0,120,24))
mosaicplot(Churn~Contract+PaymentMethod+tenure_d,data=data)
data$tenure_d <- cut(data$tenure,seq(0,90,24))
mosaicplot(Churn~Contract+PaymentMethod+tenure_d,data=data)
data$tenure_d <- cut(data$tenure,c(0,6,12,18,24,30,36,42,48,54,60,72,84,96,200))
mosaicplot(Churn~Contract+PaymentMethod+tenure_d,data=data)
data$tenure_d <- cut(data$tenure,c(0,6,12,24,36,48,60,84,200))
mosaicplot(Churn~Contract+PaymentMethod+tenure_d,data=data)
# there are'nt anyone who has moved on that did not have a phone service.
nrow(data[data$PhoneService=="No" && data$Churn=="Yes",])
phone_data<-data[data$PhoneService=='Yes',]
summary(phone_data$TotalCharges)
phone_data$TotalCharges_q <- cut(phone_data$TotalCharges,c(0,415,1422,4026,8685))
summary(phone_data$tenure)
phone_data$tenure_d <- cut(phone_data$tenure,c(0,9,29,56,72))
summary(phone_data$MonthlyCharges)
phone_data$MonthlyCharges_q <- cut(phone_data$MonthlyCharges,c(0,45,75,92,120))
mosaicplot(Churn~Contract+tenure_d+MonthlyCharges_q,data=phone_data)
phone_data$tenure_d <- cut(phone_data$tenure,c(0,6,12,24,72))
mosaicplot(Churn~Contract+tenure_d+MonthlyCharges_q,data=phone_data)
count.fields(data)
View(data)
View(data)
data<- read.csv(file="WA_Fn-UseC_-Telco-Customer-Churn.csv")
install.packages("arules")
install.packages("arules")
install.packages("arulesViz")
install.packages("arules")
install.packages("arulesViz")
install.packages("arules")
install.packages("arules");
install.packages("arules")
install.packages("arules")
install.packages("arulesViz")
library(arulesViz)
install.packages("arules")
install.packages("arules")
install.packages("arules")
library(arules)
library(arulesViz)
install.packages("robustbase")
library(arulesViz)
library(arulesViz)
library(robustbase)
install.packages("robustbase")
install.packages("gfortran")
install.packages("gfortran")
install.packages(c("cluster", "digest", "foreign", "MASS", "Matrix", "mgcv", "nlme", "survival"))
install.packages(c("cluster", "digest", "foreign", "MASS", "Matrix", "mgcv", "nlme", "survival"))
install.packages(c("cluster", "digest", "foreign", "MASS", "Matrix", "mgcv", "nlme", "survival"))
View(X)
txn <- as(phone_data,"transactions")
#install and load package arules
install.packages("arules")
library(arules)
#install and load package arules
install.packages("Matrix")
install.packages("arules")
library(arules)
library(Matrix)
library(arules)
#install and load arulesViz
install.packages("arulesViz")
library(Matrix)
